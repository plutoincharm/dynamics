(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    114646,       3290]
NotebookOptionsPosition[    108517,       3185]
NotebookOutlinePosition[    108925,       3201]
CellTagsIndexPosition[    108882,       3198]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Single support stance leg", "Title",
 CellChangeTimes->{{3.856943458575962*^9, 3.856943475498887*^9}},
 ImageSize->{323., 405.74193548387103`},
 ImageMargins->{{55.733333333333334`, 0.}, {0., 
  0.}},ExpressionUUID->"be1f2814-cac0-4e42-bb4d-19c2b6a6a3a6"],

Cell[TextData[{
 "Stage 3- toe contact\n",
 StyleBox["to add",
  FontWeight->"Bold"],
 "\n",
 StyleBox["external forces\ninput : fourier series\n",
  FontWeight->"Bold"],
 Cell[BoxData[
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1: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
AAAAAAAAAAAAAADAvPgfR6P6DA==
     "], {{0, 317.25}, {291., 0}}, {0, 255},
     ColorFunction->RGBColor,
     ImageResolution->{96., 96.},
     SmoothingQuality->"High"],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSize->Automatic,
   ImageSizeRaw->{291., 317.25},
   PlotRange->{{0, 291.}, {0, 317.25}}]], "Input",ExpressionUUID->
  "7547d2b7-94bc-4ca7-b8b5-b299b7e5b71a"],
 StyleBox["\n",
  FontWeight->"Bold"]
}], "Subtitle",
 CellChangeTimes->{{3.8569434078749013`*^9, 3.856943441915926*^9}, {
  3.8569435576422606`*^9, 3.856943563883543*^9}, {3.8569440344731665`*^9, 
  3.856944035529784*^9}, {3.8569447173671494`*^9, 3.8569447241343513`*^9}, {
  3.8569574536755514`*^9, 3.856957454094249*^9}, {3.856957663920452*^9, 
  3.8569576714053507`*^9}, {3.856957826571453*^9, 3.8569578272154894`*^9}},
 ImageSize->{323., 405.74193548387103`},
 ImageMargins->{{55.733333333333334`, 0.}, {0., 
  0.}},ExpressionUUID->"d6eec35f-036f-4c44-a625-1f4a3a55b1fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["x", "1"], "=", 
   RowBox[{
    SubscriptBox["r", "1"], "*", 
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["y", "1"], "=", 
   RowBox[{
    SubscriptBox["r", "1"], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{
      SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["x", "2"], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "1"], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "2"], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["y", "2"], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "1"], "*", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "2"], "*", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["x", "3"], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "1"], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["L", "2"], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "3"], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["y", "3"], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "1"], "*", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["L", "2"], "*", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "3"], "*", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x1", "=", 
   RowBox[{
    SubscriptBox["r", "1"], "*", 
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Theta]", "1"], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y1", "=", 
   RowBox[{
    SubscriptBox["r", "1"], "*", 
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Theta]", "1"], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x2", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "1"], "*", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "2"], "*", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "2"], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y2", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "1"], "*", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "2"], "*", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "2"], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x3", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "1"], "*", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["L", "2"], "*", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "2"], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "3"], "*", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "3"], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y3", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "1"], "*", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["L", "2"], "*", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "2"], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "3"], "*", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "3"], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8438972534210534`*^9, 3.843897297113842*^9}, {
  3.8439703902839565`*^9, 3.843970506362777*^9}, {3.844202856501876*^9, 
  3.844202887063675*^9}, {3.8569478630234823`*^9, 3.856947864462569*^9}, {
  3.8569479275143485`*^9, 
  3.8569479292157*^9}},ExpressionUUID->"7681f55b-0581-4fff-af80-563ef90bd2f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["vx", "1"], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     SubscriptBox["x", "1"], ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["vy", "1"], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     SubscriptBox["y", "1"], ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["vx", "2"], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     SubscriptBox["x", "2"], ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["vy", "2"], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     SubscriptBox["y", "2"], ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["vx", "3"], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     SubscriptBox["x", "3"], ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["vy", "3"], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     SubscriptBox["y", "3"], ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vx1", "=", 
   RowBox[{
    SubscriptBox["vx", "1"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "3"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "3"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "3"]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vy1", "=", 
   RowBox[{
    SubscriptBox["vy", "1"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "3"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "3"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "3"]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vx2", "=", 
   RowBox[{
    SubscriptBox["vx", "2"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "3"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "3"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "3"]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vy2", "=", 
   RowBox[{
    SubscriptBox["vy", "2"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "3"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "3"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "3"]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vx3", "=", 
   RowBox[{
    SubscriptBox["vx", "3"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "3"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "3"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "3"]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vy3", "=", 
   RowBox[{
    SubscriptBox["vy", "3"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "3"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "3"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "3"]}]}], "}"}]}]}], ";"}]}], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"ff8e1427-16d5-4326-83bb-c0860df068a2"],

Cell["Consider a  frictionless surface ", "Text",
 CellChangeTimes->{{3.843896891241518*^9, 3.8438969411543145`*^9}, {
  3.8569448136692686`*^9, 
  3.8569448231101103`*^9}},ExpressionUUID->"318b85a9-e273-4f74-b31c-\
96c8b419dc1a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"loop", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["L", "1"], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["L", "2"], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["R", "am"], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Theta]", "am"], "[", "t", "]"}], "]"}]}]}], ")"}], 
     "*", "nx"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["L", "1"], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["L", "2"], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["R", "am"], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Theta]", "am"], "[", "t", "]"}], "]"}]}]}], ")"}], 
     "*", "ny"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Loop", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["L", "1"], "*", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "1"], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["L", "2"], "*", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "2"], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["R", "am"], "*", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "am"], "]"}]}]}], ")"}], "*", "nx"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["L", "1"], "*", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "1"], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["L", "2"], "*", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "2"], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["R", "am"], "*", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "am"], "]"}]}]}], ")"}], "*", "ny"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.843970528459568*^9, 3.843970567295746*^9}, {
  3.84397459441152*^9, 3.8439746007380476`*^9}, {3.8442028996788535`*^9, 
  3.844202907232701*^9}, {3.8569432853566127`*^9, 3.856943354268278*^9}, {
  3.856957727330927*^9, 
  3.856957749085943*^9}},ExpressionUUID->"cfc5c6f9-08c4-4ac9-bd32-\
dc2b6190c82d"],

Cell["Augmented Lagrangian formulation", "Text",
 CellChangeTimes->{{3.843896994703909*^9, 3.8438969947089133`*^9}, {
  3.843897032410934*^9, 
  3.843897050489583*^9}},ExpressionUUID->"217b16d4-6999-48ec-a50b-\
41975b580b91"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["ke", "1"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     SubscriptBox["m", "1"], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["vx", "1"], "^", "2"}], "+", 
       RowBox[{
        SubscriptBox["vy", "1"], "^", "2"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     SubscriptBox["MI", "1"], "*", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Omega]", "1"], "[", "t", "]"}], "^", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["ke", "2"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     SubscriptBox["m", "2"], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["vx", "2"], "^", "2"}], "+", 
       RowBox[{
        SubscriptBox["vy", "2"], "^", "2"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     SubscriptBox["MI", "2"], "*", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Omega]", "2"], "[", "t", "]"}], "^", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["ke", "3"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     SubscriptBox["m", "3"], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["vx", "3"], "^", "2"}], "+", 
       RowBox[{
        SubscriptBox["vy", "3"], "^", "2"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     SubscriptBox["MI", "3"], "*", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Omega]", "3"], "[", "t", "]"}], "^", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["pe", "1"], "=", 
   RowBox[{
    SubscriptBox["m", "1"], "*", "g", "*", 
    SubscriptBox["y", "1"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["pe", "2"], "=", 
   RowBox[{
    SubscriptBox["m", "2"], "*", "g", "*", 
    SubscriptBox["y", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["pe", "3"], "=", 
   RowBox[{
    SubscriptBox["m", "3"], "*", "g", "*", 
    SubscriptBox["y", "3"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ke1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     SubscriptBox["m", "1"], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"vx1", "^", "2"}], "+", 
       RowBox[{"vy1", "^", "2"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     SubscriptBox["MI", "1"], "*", 
     RowBox[{
      SubscriptBox["\[Omega]", "1"], "^", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ke2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     SubscriptBox["m", "2"], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"vx2", "^", "2"}], "+", 
       RowBox[{"vy2", "^", "2"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     SubscriptBox["MI", "2"], "*", 
     RowBox[{
      SubscriptBox["\[Omega]", "2"], "^", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ke3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     SubscriptBox["m", "3"], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"vx3", "^", "2"}], "+", 
       RowBox[{"vy3", "^", "2"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     SubscriptBox["MI", "3"], "*", 
     RowBox[{
      SubscriptBox["\[Omega]", "3"], "^", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pe1", "=", 
   RowBox[{
    SubscriptBox["m", "1"], "*", "g", "*", "y1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pe2", "=", 
   RowBox[{
    SubscriptBox["m", "2"], "*", "g", "*", "y2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pe3", "=", 
   RowBox[{
    SubscriptBox["m", "3"], "*", "g", "*", "y3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"lag", "=", 
  RowBox[{
   SubscriptBox["ke", "1"], "+", 
   SubscriptBox["ke", "2"], "+", 
   SubscriptBox["ke", "3"], "-", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["pe", "1"], "+", 
     SubscriptBox["pe", "2"], "+", 
     SubscriptBox["pe", "3"]}], ")"}], "+", 
   RowBox[{"\[Lambda]", "*", "loop"}], " ", "+", 
   RowBox[{
    SubscriptBox["T", "1"], "*", 
    RowBox[{
     SubscriptBox["\[Theta]", "1"], "[", "t", "]"}]}], "+", 
   RowBox[{
    SubscriptBox["T", "2"], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "-", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "[", "t", "]"}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["T", "3"], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "-", 
      RowBox[{
       SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "-", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "[", "t", "]"}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Fe", "x"], "*", 
    SubscriptBox["x", "1"]}], "+", 
   RowBox[{
    SubscriptBox["Fe", "y"], "*", 
    SubscriptBox["y", "1"]}], " ", "+", 
   RowBox[{"Me", "*", "\[CurlyPhi]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lag", "=", 
   RowBox[{"ke1", "+", "ke2", "+", "ke3", "-", 
    RowBox[{"(", 
     RowBox[{"pe1", "+", "pe2", "+", "pe3"}], ")"}], "+", 
    RowBox[{"\[Lambda]", "*", "Loop"}], "+", 
    RowBox[{
     SubscriptBox["T", "1"], "*", 
     SubscriptBox["\[Theta]", "1"]}], "+", 
    RowBox[{
     SubscriptBox["T", "2"], "*", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Theta]", "2"], "-", 
       SubscriptBox["\[Theta]", "1"]}], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["T", "3"], "*", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Theta]", "3"], "-", 
       SubscriptBox["\[Theta]", "2"], "-", 
       SubscriptBox["\[Theta]", "1"]}], ")"}]}], "+", 
    RowBox[{
     SubscriptBox["Fe", "x"], "*", "x1"}], "+", 
    RowBox[{
     SubscriptBox["Fe", "y"], "*", "y1"}], " ", "+", 
    RowBox[{"Me", "*", "\[CurlyPhi]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8438971042099547`*^9, 3.8438971327936854`*^9}, {
  3.8438973100267744`*^9, 3.8438974276818104`*^9}, {3.856943833723886*^9, 
  3.8569438862545605`*^9}, {3.856943935998901*^9, 3.8569439631183105`*^9}, {
  3.8569442092613564`*^9, 3.856944211214238*^9}, {3.856947411041301*^9, 
  3.856947417180434*^9}, {3.8569476926739287`*^9, 3.856947757682617*^9}, {
  3.856947794846753*^9, 3.8569478082714753`*^9}, {3.856947841711033*^9, 
  3.8569479565220704`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"b4996eb1-9360-40a9-9d40-7da579894fc7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Me", " ", "\[CurlyPhi]"}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{
     SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}], " ", 
   SubscriptBox["Fe", "x"], " ", 
   SubscriptBox["r", "1"]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{
     SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}], " ", 
   SubscriptBox["Fe", "y"], " ", 
   SubscriptBox["r", "1"]}], "-", 
  RowBox[{"g", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}], " ", 
   SubscriptBox["m", "1"], " ", 
   SubscriptBox["r", "1"]}], "-", 
  RowBox[{"g", " ", 
   SubscriptBox["m", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["L", "1"]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["r", "2"]}]}], ")"}]}], "-", 
  RowBox[{"g", " ", 
   SubscriptBox["m", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["L", "1"]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["L", "2"]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["r", "3"]}]}], ")"}]}], "+", 
  RowBox[{"\[Lambda]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"nx", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["L", "1"]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["L", "2"]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["R", "ah"]}]}], ")"}]}], "+", 
     RowBox[{"ny", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["L", "1"]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["L", "2"]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["R", "ah"]}]}], ")"}]}]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["T", "1"], " ", 
   RowBox[{
    SubscriptBox["\[Theta]", "1"], "[", "t", "]"}]}], "+", 
  RowBox[{
   SubscriptBox["T", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["\[Theta]", "2"], "[", "t", "]"}]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["T", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "[", "t", "]"}]}], "-", 
     RowBox[{
      SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "+", 
     RowBox[{
      SubscriptBox["\[Theta]", "3"], "[", "t", "]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SubscriptBox["MI", "1"], " ", 
   SuperscriptBox[
    RowBox[{
     SubscriptBox["\[Omega]", "1"], "[", "t", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SubscriptBox["MI", "2"], " ", 
   SuperscriptBox[
    RowBox[{
     SubscriptBox["\[Omega]", "2"], "[", "t", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SubscriptBox["MI", "3"], " ", 
   SuperscriptBox[
    RowBox[{
     SubscriptBox["\[Omega]", "3"], "[", "t", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SubscriptBox["m", "1"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}], "2"], " ", 
      SubsuperscriptBox["r", "1", "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Theta]", "1"], "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}], "2"], " ", 
      SubsuperscriptBox["r", "1", "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Theta]", "1"], "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SubscriptBox["m", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["L", "1"], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Theta]", "1"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["r", "2"], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Theta]", "2"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}]}], " ", 
         SubscriptBox["L", "1"], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Theta]", "1"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["r", "2"], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Theta]", "2"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}], "2"]}], 
    ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SubscriptBox["m", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["L", "1"], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Theta]", "1"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["L", "2"], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Theta]", "2"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["r", "3"], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Theta]", "3"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}]}], " ", 
         SubscriptBox["L", "1"], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Theta]", "1"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["L", "2"], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Theta]", "2"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["r", "3"], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Theta]", "3"], "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}], "2"]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8569479178756027`*^9, 3.8569479571673746`*^9}},
 CellLabel->
  "Out[109]=",ExpressionUUID->"6847be39-87aa-4fe4-bd2d-0ed987227bd2"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DLagDomg1", "=", 
   RowBox[{"D", "[", 
    RowBox[{"Lag", ",", 
     SubscriptBox["\[Omega]", "1"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DLagDomg2", "=", 
   RowBox[{"D", "[", 
    RowBox[{"Lag", ",", 
     SubscriptBox["\[Omega]", "2"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DLagDomg3", "=", 
   RowBox[{"D", "[", 
    RowBox[{"Lag", ",", 
     SubscriptBox["\[Omega]", "3"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DLagDtht1", "=", 
   RowBox[{"D", "[", 
    RowBox[{"Lag", ",", 
     SubscriptBox["\[Theta]", "1"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DLagDtht2", "=", 
   RowBox[{"D", "[", 
    RowBox[{"Lag", ",", 
     SubscriptBox["\[Theta]", "2"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DLagDtht3", "=", 
   RowBox[{"D", "[", 
    RowBox[{"Lag", ",", 
     SubscriptBox["\[Theta]", "3"]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.8569448495782537`*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"b6c017aa-43af-41b1-bef9-efed002f18ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["DLagDomg", "1"], "=", 
   RowBox[{"DLagDomg1", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Omega]", "1"], "\[Rule]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "'"}], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[Omega]", "2"], "\[Rule]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "'"}], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[Omega]", "3"], "\[Rule]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "3"], "'"}], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "\[Rule]", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[Theta]", "2"], "\[Rule]", 
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[Theta]", "3"], "\[Rule]", 
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "[", "t", "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["DLagDomg", "2"], "=", 
   RowBox[{"DLagDomg2", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Omega]", "1"], "\[Rule]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "'"}], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[Omega]", "2"], "\[Rule]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "'"}], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[Omega]", "3"], "\[Rule]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "3"], "'"}], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "\[Rule]", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[Theta]", "2"], "\[Rule]", 
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[Theta]", "3"], "\[Rule]", 
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "[", "t", "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["DLagDomg", "3"], "=", 
   RowBox[{"DLagDomg3", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Omega]", "1"], "\[Rule]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "'"}], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[Omega]", "2"], "\[Rule]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "'"}], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[Omega]", "3"], "\[Rule]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "3"], "'"}], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "\[Rule]", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[Theta]", "2"], "\[Rule]", 
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[Theta]", "3"], "\[Rule]", 
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "[", "t", "]"}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellLabel->"In[47]:=",ExpressionUUID->"4053694e-ed54-4ea5-9b35-87144c8f80c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["dtDlagDomg", "1"], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     SubscriptBox["DLagDomg", "1"], ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dtDlagDomg", "2"], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     SubscriptBox["DLagDomg", "2"], ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dtDlagDomg", "3"], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     SubscriptBox["DLagDomg", "3"], ",", "t"}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[50]:=",ExpressionUUID->"fcfdde4a-fc31-4fe1-a2fa-9942ba8e7abf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dtDlagDomg1", "=", 
   RowBox[{
    SubscriptBox["dtDlagDomg", "1"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "''"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Alpha]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "''"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Alpha]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "3"], "''"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Alpha]", "3"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "3"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "3"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "3"]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dtDlagDomg2", "=", 
   RowBox[{
    SubscriptBox["dtDlagDomg", "2"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "''"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Alpha]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "''"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Alpha]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "3"], "''"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Alpha]", "3"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "3"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "3"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "3"]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dtDlagDomg3", "=", 
   RowBox[{
    SubscriptBox["dtDlagDomg", "3"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "''"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Alpha]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "''"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Alpha]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "3"], "''"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Alpha]", "3"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "3"], "'"}], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Omega]", "3"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "1"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "2"]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "\[Rule]", 
       SubscriptBox["\[Theta]", "3"]}]}], "}"}]}]}], ";"}]}], "Input",
 CellLabel->"In[53]:=",ExpressionUUID->"9c5da377-5c8d-490f-9b3a-54dd51712bb7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EoM1", "=", 
  RowBox[{
   RowBox[{"dtDlagDomg1", "-", "DLagDtht1"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.843897534045077*^9, 3.8438975425678234`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"bcc0a1a7-f25e-40d9-8e42-1391b73920b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SubscriptBox["T", "1"]}], "+", 
  SubscriptBox["T", "2"], "+", 
  SubscriptBox["T", "3"], "+", 
  RowBox[{
   SubsuperscriptBox["L", "1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["m", "2"], "+", 
     SubscriptBox["m", "3"]}], ")"}], " ", 
   SubscriptBox["\[Alpha]", "1"]}], "+", 
  RowBox[{
   SubscriptBox["MI", "1"], " ", 
   SubscriptBox["\[Alpha]", "1"]}], "+", 
  RowBox[{
   SubscriptBox["m", "1"], " ", 
   SubscriptBox["r", "1"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"g", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}]}], "+", 
     RowBox[{
      SubscriptBox["r", "1"], " ", 
      SubscriptBox["\[Alpha]", "1"]}]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["L", "1"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "ny"}], " ", "\[Lambda]", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}]}], "+", 
     RowBox[{"nx", " ", "\[Lambda]", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}]}], "+", 
     RowBox[{
      SubscriptBox["m", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "1"], "]"}]}], "+", 
        RowBox[{
         SubscriptBox["r", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "1"], "-", 
              SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
            SubscriptBox["\[Alpha]", "2"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "1"], "-", 
              SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
            SubsuperscriptBox["\[Omega]", "2", "2"]}]}], ")"}]}]}], ")"}]}], 
     "+", 
     RowBox[{
      SubscriptBox["m", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "1"], "]"}]}], "+", 
        RowBox[{
         SubscriptBox["L", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "1"], "-", 
              SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
            SubscriptBox["\[Alpha]", "2"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "1"], "-", 
              SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
            SubsuperscriptBox["\[Omega]", "2", "2"]}]}], ")"}]}], "+", 
        RowBox[{
         SubscriptBox["r", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "1"], "-", 
              SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
            SubscriptBox["\[Alpha]", "3"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "1"], "-", 
              SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
            SubsuperscriptBox["\[Omega]", "3", "2"]}]}], ")"}]}]}], ")"}]}]}],
     ")"}]}]}]], "Output",
 CellChangeTimes->{3.843897544674801*^9, 3.843974635667998*^9, 
  3.844202921501238*^9, 3.856943118229372*^9, 3.856944140067196*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"33fd5c6c-667b-4716-bd7c-db717932621d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EoM2", "=", 
  RowBox[{
   RowBox[{"dtDlagDomg2", "-", "DLagDtht2"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.843897575472516*^9, 3.843897578487645*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"e5fbfb58-fac4-4119-abea-0b5e84eb881c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SubscriptBox["T", "2"]}], "+", 
  SubscriptBox["T", "3"], "+", 
  RowBox[{
   SubsuperscriptBox["L", "2", "2"], " ", 
   SubscriptBox["m", "3"], " ", 
   SubscriptBox["\[Alpha]", "2"]}], "+", 
  RowBox[{
   SubscriptBox["MI", "2"], " ", 
   SubscriptBox["\[Alpha]", "2"]}], "+", 
  RowBox[{
   SubscriptBox["m", "2"], " ", 
   SubscriptBox["r", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"g", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "2"], "]"}]}], "+", 
     RowBox[{
      SubscriptBox["r", "2"], " ", 
      SubscriptBox["\[Alpha]", "2"]}], "+", 
     RowBox[{
      SubscriptBox["L", "1"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "1"], "-", 
           SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
         SubscriptBox["\[Alpha]", "1"]}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "1"], "-", 
           SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
         SubsuperscriptBox["\[Omega]", "1", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["L", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "ny"}], " ", "\[Lambda]", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "2"], "]"}]}], "+", 
     RowBox[{"nx", " ", "\[Lambda]", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "2"], "]"}]}], "+", 
     RowBox[{
      SubscriptBox["m", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "2"], "]"}]}], "+", 
        RowBox[{
         SubscriptBox["L", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "1"], "-", 
              SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
            SubscriptBox["\[Alpha]", "1"]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "1"], "-", 
              SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
            SubsuperscriptBox["\[Omega]", "1", "2"]}]}], ")"}]}], "+", 
        RowBox[{
         SubscriptBox["r", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "2"], "-", 
              SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
            SubscriptBox["\[Alpha]", "3"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "2"], "-", 
              SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
            SubsuperscriptBox["\[Omega]", "3", "2"]}]}], ")"}]}]}], ")"}]}]}],
     ")"}]}]}]], "Output",
 CellChangeTimes->{3.8438975801848245`*^9, 3.8439746399695024`*^9, 
  3.8442029238713074`*^9, 3.8569431186393704`*^9, 3.856944140539195*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"a5685664-1ed6-4741-b24e-cd9bef6e618f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EoM3", "=", 
  RowBox[{
   RowBox[{"dtDlagDomg3", "-", "DLagDtht3"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.8438976447765512`*^9, 3.843897647295741*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"aafbd9b4-8678-467f-a63c-6250d1c6a4a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SubscriptBox["T", "3"]}], "+", 
  RowBox[{
   SubscriptBox["MI", "3"], " ", 
   SubscriptBox["\[Alpha]", "3"]}], "+", 
  RowBox[{
   SubscriptBox["m", "3"], " ", 
   SubscriptBox["r", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"g", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "3"], "]"}]}], "+", 
     RowBox[{
      SubscriptBox["r", "3"], " ", 
      SubscriptBox["\[Alpha]", "3"]}], "+", 
     RowBox[{
      SubscriptBox["L", "1"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "1"], "-", 
           SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
         SubscriptBox["\[Alpha]", "1"]}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "1"], "-", 
           SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
         SubsuperscriptBox["\[Omega]", "1", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox["L", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "2"], "-", 
           SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
         SubscriptBox["\[Alpha]", "2"]}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "2"], "-", 
           SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
         SubsuperscriptBox["\[Omega]", "2", "2"]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.843897648769906*^9, 3.8439746427517595`*^9, 
  3.8442029263082027`*^9, 3.856943118953701*^9, 3.8569441407931952`*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"5d04a65c-083e-483c-b634-619eba4a2f03"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"solacc", "=", 
   RowBox[{
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EoM1", "\[Equal]", "0"}], ",", 
        RowBox[{"EoM2", "\[Equal]", "0"}], ",", 
        RowBox[{"EoM3", "\[Equal]", "0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[Alpha]", "1"], ",", 
        SubscriptBox["\[Alpha]", "2"], ",", 
        SubscriptBox["\[Alpha]", "3"]}], "}"}]}], "]"}], "//", "Normal"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mmat", "=", 
   RowBox[{"solacc", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Mmat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8439528415116324`*^9, 3.843952928531781*^9}, {
  3.8439765452394705`*^9, 3.843976559442371*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"47ead4f3-2a6f-4629-b16e-ca1fc1890901"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        SubsuperscriptBox["L", "1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["m", "2"], "+", 
          SubscriptBox["m", "3"]}], ")"}]}], "+", 
       SubscriptBox["MI", "1"], "+", 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubsuperscriptBox["r", "1", "2"]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Theta]", "1"], "-", 
          SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
        SubscriptBox["L", "1"], " ", 
        SubscriptBox["L", "2"], " ", 
        SubscriptBox["m", "3"]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Theta]", "1"], "-", 
          SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
        SubscriptBox["L", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["r", "2"]}]}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "-", 
         SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
       SubscriptBox["L", "1"], " ", 
       SubscriptBox["m", "3"], " ", 
       SubscriptBox["r", "3"]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Theta]", "1"], "-", 
          SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
        SubscriptBox["L", "1"], " ", 
        SubscriptBox["L", "2"], " ", 
        SubscriptBox["m", "3"]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Theta]", "1"], "-", 
          SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
        SubscriptBox["L", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["r", "2"]}]}], 
      RowBox[{
       RowBox[{
        SubsuperscriptBox["L", "2", "2"], " ", 
        SubscriptBox["m", "3"]}], "+", 
       SubscriptBox["MI", "2"], "+", 
       RowBox[{
        SubscriptBox["m", "2"], " ", 
        SubsuperscriptBox["r", "2", "2"]}]}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "-", 
         SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
       SubscriptBox["L", "2"], " ", 
       SubscriptBox["m", "3"], " ", 
       SubscriptBox["r", "3"]}]},
     {
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "-", 
         SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
       SubscriptBox["L", "1"], " ", 
       SubscriptBox["m", "3"], " ", 
       SubscriptBox["r", "3"]}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "2"], "-", 
         SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
       SubscriptBox["L", "2"], " ", 
       SubscriptBox["m", "3"], " ", 
       SubscriptBox["r", "3"]}], 
      RowBox[{
       SubscriptBox["MI", "3"], "+", 
       RowBox[{
        SubscriptBox["m", "3"], " ", 
        SubsuperscriptBox["r", "3", "2"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.84395292963756*^9, 3.8439746442958045`*^9, {3.8439765481662445`*^9, 
   3.8439765603165092`*^9}, 3.8442029592672014`*^9, 3.8569431189797053`*^9, 
   3.8569441408182*^9},
 CellLabel->
  "Out[61]//MatrixForm=",ExpressionUUID->"bd2cb327-efbf-476b-9c6e-\
1660a5ced352"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"solrhs1", "=", 
   RowBox[{
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EoM1", "\[Equal]", "0"}], ",", 
        RowBox[{"EoM2", "\[Equal]", "0"}], ",", 
        RowBox[{"EoM3", "\[Equal]", "0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[Alpha]", "1"], ",", 
        SubscriptBox["\[Alpha]", "2"], ",", 
        SubscriptBox["\[Alpha]", "3"], ",", "\[Lambda]"}], "}"}]}], "]"}], "//",
     "Normal"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rhs1", "=", 
  RowBox[{"-", 
   RowBox[{"solrhs1", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8439529523564596`*^9, 3.843952988779735*^9}, 
   3.843955242724352*^9},
 CellLabel->"In[62]:=",ExpressionUUID->"d8a1e8d1-6627-4525-8a95-2c6e496c8770"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "g"}], " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}], " ", 
     SubscriptBox["L", "1"], " ", 
     SubscriptBox["m", "2"]}], "-", 
    RowBox[{"g", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}], " ", 
     SubscriptBox["L", "1"], " ", 
     SubscriptBox["m", "3"]}], "-", 
    RowBox[{"g", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}], " ", 
     SubscriptBox["m", "1"], " ", 
     SubscriptBox["r", "1"]}], "+", 
    SubscriptBox["T", "1"], "-", 
    SubscriptBox["T", "2"], "-", 
    SubscriptBox["T", "3"], "-", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "-", 
       SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
     SubscriptBox["L", "1"], " ", 
     SubscriptBox["L", "2"], " ", 
     SubscriptBox["m", "3"], " ", 
     SubsuperscriptBox["\[Omega]", "2", "2"]}], "-", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "-", 
       SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
     SubscriptBox["L", "1"], " ", 
     SubscriptBox["m", "2"], " ", 
     SubscriptBox["r", "2"], " ", 
     SubsuperscriptBox["\[Omega]", "2", "2"]}], "-", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "-", 
       SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
     SubscriptBox["L", "1"], " ", 
     SubscriptBox["m", "3"], " ", 
     SubscriptBox["r", "3"], " ", 
     SubsuperscriptBox["\[Omega]", "3", "2"]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "g"}], " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "2"], "]"}], " ", 
     SubscriptBox["L", "2"], " ", 
     SubscriptBox["m", "3"]}], "-", 
    RowBox[{"g", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "2"], "]"}], " ", 
     SubscriptBox["m", "2"], " ", 
     SubscriptBox["r", "2"]}], "+", 
    SubscriptBox["T", "2"], "-", 
    SubscriptBox["T", "3"], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "-", 
       SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
     SubscriptBox["L", "1"], " ", 
     SubscriptBox["L", "2"], " ", 
     SubscriptBox["m", "3"], " ", 
     SubsuperscriptBox["\[Omega]", "1", "2"]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "-", 
       SubscriptBox["\[Theta]", "2"]}], "]"}], " ", 
     SubscriptBox["L", "1"], " ", 
     SubscriptBox["m", "2"], " ", 
     SubscriptBox["r", "2"], " ", 
     SubsuperscriptBox["\[Omega]", "1", "2"]}], "-", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "2"], "-", 
       SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
     SubscriptBox["L", "2"], " ", 
     SubscriptBox["m", "3"], " ", 
     SubscriptBox["r", "3"], " ", 
     SubsuperscriptBox["\[Omega]", "3", "2"]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "g"}], " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "3"], "]"}], " ", 
     SubscriptBox["m", "3"], " ", 
     SubscriptBox["r", "3"]}], "+", 
    SubscriptBox["T", "3"], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "-", 
       SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
     SubscriptBox["L", "1"], " ", 
     SubscriptBox["m", "3"], " ", 
     SubscriptBox["r", "3"], " ", 
     SubsuperscriptBox["\[Omega]", "1", "2"]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "2"], "-", 
       SubscriptBox["\[Theta]", "3"]}], "]"}], " ", 
     SubscriptBox["L", "2"], " ", 
     SubscriptBox["m", "3"], " ", 
     SubscriptBox["r", "3"], " ", 
     SubsuperscriptBox["\[Omega]", "2", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.8439529934786673`*^9, 3.843955243683024*^9, 
  3.8439746466784964`*^9, 3.8442029623853703`*^9, 3.856943118991701*^9, 
  3.856944140843198*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"5189e315-b221-4a0c-8051-1b6e8ca4f44b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"coefflam", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"solrhs1", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1", ",", "4"}], "]"}], "]"}], ",", 
    RowBox[{"solrhs1", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2", ",", "4"}], "]"}], "]"}], ",", 
    RowBox[{"solrhs1", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "3", ",", "4"}], "]"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.84395301680134*^9, 3.8439531267684402`*^9}, {
  3.843953256864753*^9, 3.843953307375824*^9}, {3.843953405824299*^9, 
  3.8439534503500743`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"282f86b8-fff6-434c-80ff-1a3a66b33f5b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "ny"}], " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}], " ", 
     SubscriptBox["L", "1"]}], "+", 
    RowBox[{"nx", " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "1"], "]"}], " ", 
     SubscriptBox["L", "1"]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "ny"}], " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "2"], "]"}], " ", 
     SubscriptBox["L", "2"]}], "+", 
    RowBox[{"nx", " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "2"], "]"}], " ", 
     SubscriptBox["L", "2"]}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8439533080293045`*^9, {3.843953415944109*^9, 3.8439534511113033`*^9}, 
   3.8439746797006044`*^9, 3.8442029656883135`*^9, 3.8569431190157013`*^9, 
   3.856944140850195*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"c59eaba6-6119-4f72-88f1-aff43ae358a4"]
}, Open  ]],

Cell["\<\
Note that nx<0, ny>0 => and as per current config as \[Theta]s are in 4th \
quadrant => in above array all entries are >0 \
\>", "Text",
 CellChangeTimes->{{3.843955384978191*^9, 3.8439554355302854`*^9}, {
  3.8439555648254604`*^9, 3.8439555700176477`*^9}, {3.8439747193524303`*^9, 
  3.8439747430003853`*^9}, {3.84397529393159*^9, 
  3.8439753384449406`*^9}},ExpressionUUID->"e1e0c561-292b-43fa-8984-\
908957456adf"],

Cell["Loop closure and derivatives", "Text",
 CellChangeTimes->{{3.843954837045332*^9, 
  3.8439548445005007`*^9}},ExpressionUUID->"95b7c19b-7039-4d2a-8cef-\
51142c43bbc4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Dloop", "=", 
  RowBox[{"D", "[", 
   RowBox[{"loop", ",", "t"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"D2loop", "=", 
  RowBox[{"D", "[", 
   RowBox[{"Dloop", ",", "t"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8439531611107016`*^9, 3.843953179128603*^9}, {
  3.8439548675120797`*^9, 3.843954899782936*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"665cb163-9d4e-4d72-86bb-ee1b6f8f6e36"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ny", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["L", "1"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "1"], "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["L", "2"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "2"], "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["R", "ah"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "ah"], "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"nx", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}]}], " ", 
      SubscriptBox["L", "1"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "1"], "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["L", "2"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "2"], "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["R", "ah"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "ah"], "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.843953181509612*^9, {3.8439548757861195`*^9, 3.8439549014701757`*^9}, 
   3.843974748100222*^9, 3.8442029679754267`*^9, 3.856943119041701*^9, 
   3.856944140874196*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"0fc69d17-33a6-4abb-97f9-730a4b900a8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ny", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}]}], " ", 
      SubscriptBox["L", "1"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Theta]", "1"], "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["L", "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Theta]", "2"], "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["R", "ah"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Theta]", "ah"], "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["L", "1"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "1"], "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["L", "2"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "2"], "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["R", "ah"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "ah"], "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"nx", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}]}], " ", 
      SubscriptBox["L", "1"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Theta]", "1"], "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["L", "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Theta]", "2"], "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["R", "ah"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Theta]", "ah"], "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["L", "1"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "1"], "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["L", "2"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "2"], "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["R", "ah"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "ah"], "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.843953181509612*^9, {3.8439548757861195`*^9, 3.8439549014701757`*^9}, 
   3.843974748100222*^9, 3.8442029679754267`*^9, 3.856943119041701*^9, 
   3.856944140881194*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"f3738494-e4bf-4baf-b74d-5caa7a255732"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Dl", "=", 
  RowBox[{"Dloop", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "'"}], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["\[Omega]", "1"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "'"}], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["\[Omega]", "2"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "'"}], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["\[Omega]", "3"]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["\[Theta]", "1"]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["\[Theta]", "2"]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["\[Theta]", "3"]}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"D2l", "=", 
  RowBox[{"D2loop", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "''"}], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["\[Alpha]", "1"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "''"}], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["\[Alpha]", "2"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "''"}], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["\[Alpha]", "3"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "'"}], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["\[Omega]", "1"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "'"}], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["\[Omega]", "2"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "'"}], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["\[Omega]", "3"]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "1"], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["\[Theta]", "1"]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "2"], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["\[Theta]", "2"]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "3"], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["\[Theta]", "3"]}]}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.843953185405566*^9, 3.8439532220241923`*^9}, {
  3.8439532876798573`*^9, 3.843953297455736*^9}, {3.8439549136533995`*^9, 
  3.8439549834542584`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"891a5d2a-3d5b-463d-830e-855749c9813a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ny", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], " ", 
      SubscriptBox["L", "1"], " ", 
      SubscriptBox["\[Omega]", "1"]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "2"], "]"}], " ", 
      SubscriptBox["L", "2"], " ", 
      SubscriptBox["\[Omega]", "2"]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["R", "ah"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "ah"], "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"nx", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Theta]", "1"], "]"}]}], " ", 
      SubscriptBox["L", "1"], " ", 
      SubscriptBox["\[Omega]", "1"]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "2"], "]"}], " ", 
      SubscriptBox["L", "2"], " ", 
      SubscriptBox["\[Omega]", "2"]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["R", "ah"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "ah"], "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.843953299002845*^9, 3.8439549840033474`*^9, 
  3.8439747533010426`*^9, 3.8442029698307343`*^9, 3.8569431190727005`*^9, 
  3.8569441409041953`*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"0a0d6baa-285f-4909-b33c-db542d37b13b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ny", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], " ", 
      SubscriptBox["L", "1"], " ", 
      SubscriptBox["\[Alpha]", "1"]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "2"], "]"}], " ", 
      SubscriptBox["L", "2"], " ", 
      SubscriptBox["\[Alpha]", "2"]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], " ", 
      SubscriptBox["L", "1"], " ", 
      SubsuperscriptBox["\[Omega]", "1", "2"]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "2"], "]"}], " ", 
      SubscriptBox["L", "2"], " ", 
      SubsuperscriptBox["\[Omega]", "2", "2"]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["R", "ah"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Theta]", "ah"], "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["R", "ah"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "ah"], "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"nx", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Theta]", "1"], "]"}]}], " ", 
      SubscriptBox["L", "1"], " ", 
      SubscriptBox["\[Alpha]", "1"]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "2"], "]"}], " ", 
      SubscriptBox["L", "2"], " ", 
      SubscriptBox["\[Alpha]", "2"]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], " ", 
      SubscriptBox["L", "1"], " ", 
      SubsuperscriptBox["\[Omega]", "1", "2"]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "2"], "]"}], " ", 
      SubscriptBox["L", "2"], " ", 
      SubsuperscriptBox["\[Omega]", "2", "2"]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["R", "ah"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Theta]", "ah"], "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["R", "ah"], " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Theta]", "ah"], "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.843953299002845*^9, 3.8439549840033474`*^9, 
  3.8439747533010426`*^9, 3.8442029698307343`*^9, 3.8569431190727005`*^9, 
  3.8569441409131947`*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"b1d273c1-e60d-4507-9720-4933cc4c6deb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"solC", "=", 
   RowBox[{
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"D2l", "\[Equal]", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[Alpha]", "1"], ",", 
        SubscriptBox["\[Alpha]", "2"], ",", 
        SubscriptBox["\[Alpha]", "3"]}], "}"}]}], "]"}], "//", "Normal"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"coeffC", "=", 
  RowBox[{"solC", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"rhs2", "=", 
  RowBox[{"-", 
   RowBox[{"solC", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8439551311686935`*^9, 3.843955184195958*^9}, {
  3.843955257110573*^9, 3.843955298364605*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"cc655fd2-3cdf-4fca-95ef-3dac43bbbb07"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"ny", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], " ", 
      SubscriptBox["L", "1"]}], "-", 
     RowBox[{"nx", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "1"], "]"}], " ", 
      SubscriptBox["L", "1"]}]}], ",", 
    RowBox[{
     RowBox[{"ny", " ", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "2"], "]"}], " ", 
      SubscriptBox["L", "2"]}], "-", 
     RowBox[{"nx", " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "2"], "]"}], " ", 
      SubscriptBox["L", "2"]}]}], ",", "0"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.8439552819821835`*^9, 3.84395529899254*^9}, 
   3.84397476301995*^9, 3.8442029719673605`*^9, 3.856943119104701*^9, 
   3.8569441409371967`*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"e8e9094c-1e43-4a6d-8ab3-dbbcf7d1a6ce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"nx", " ", 
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Theta]", "1"], "]"}], " ", 
    SubscriptBox["L", "1"], " ", 
    SubsuperscriptBox["\[Omega]", "1", "2"]}], "+", 
   RowBox[{"ny", " ", 
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Theta]", "1"], "]"}], " ", 
    SubscriptBox["L", "1"], " ", 
    SubsuperscriptBox["\[Omega]", "1", "2"]}], "+", 
   RowBox[{"nx", " ", 
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Theta]", "2"], "]"}], " ", 
    SubscriptBox["L", "2"], " ", 
    SubsuperscriptBox["\[Omega]", "2", "2"]}], "+", 
   RowBox[{"ny", " ", 
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Theta]", "2"], "]"}], " ", 
    SubscriptBox["L", "2"], " ", 
    SubsuperscriptBox["\[Omega]", "2", "2"]}], "+", 
   RowBox[{"nx", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
    SubscriptBox["R", "ah"], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Theta]", "ah"], "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
   RowBox[{"ny", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
    SubscriptBox["R", "ah"], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Theta]", "ah"], "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
   RowBox[{"ny", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
    SubscriptBox["R", "ah"], " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Theta]", "ah"], "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "+", 
   RowBox[{"nx", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
    SubscriptBox["R", "ah"], " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Theta]", "ah"], "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8439552819821835`*^9, 3.84395529899254*^9}, 
   3.84397476301995*^9, 3.8442029719673605`*^9, 3.856943119104701*^9, 
   3.8569441409451942`*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"8a320cd7-b441-45c4-93e1-0e0e40400c2e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"nx", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "1"], "]"}], " ", 
       SubscriptBox["L", "1"], " ", 
       SubsuperscriptBox["\[Omega]", "1", "2"]}], "+", 
      RowBox[{"ny", " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Theta]", "1"], "]"}], " ", 
       SubscriptBox["L", "1"], " ", 
       SubsuperscriptBox["\[Omega]", "1", "2"]}], "+", 
      RowBox[{"nx", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "2"], "]"}], " ", 
       SubscriptBox["L", "2"], " ", 
       SubsuperscriptBox["\[Omega]", "2", "2"]}], "+", 
      RowBox[{"ny", " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Theta]", "2"], "]"}], " ", 
       SubscriptBox["L", "2"], " ", 
       SubsuperscriptBox["\[Omega]", "2", "2"]}], "+", 
      RowBox[{"nx", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "3"], "]"}], " ", 
       SubscriptBox["L", "3"], " ", 
       SubsuperscriptBox["\[Omega]", "3", "2"]}], "+", 
      RowBox[{"ny", " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Theta]", "3"], "]"}], " ", 
       SubscriptBox["L", "3"], " ", 
       SubsuperscriptBox["\[Omega]", "3", "2"]}]}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["L", "1"], " ", 
         SubsuperscriptBox["\[Omega]", "1", "2"]}], "|", "n", "|", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "1"], "-", "\[Phi]"}], "]"}], "+", 
         RowBox[{
          SubscriptBox["L", "2"], " ", 
          SubsuperscriptBox["\[Omega]", "2", "2"]}]}], "|", "n", "|", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "2"], "-", "\[Phi]"}], "]"}], "+", 
         RowBox[{
          SubscriptBox["L", "3"], " ", 
          SubsuperscriptBox["\[Omega]", "3", "2"]}]}], "|", "n", "|", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Theta]", "3"], "-", "\[Phi]"}], "]"}]}], "}"}], 
      "\[IndentingNewLine]", "|", "n", "|"}], "=", "1"}]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"and", " ", "\[Phi]"}], "=", 
     RowBox[{
      RowBox[{
      "angle", " ", "made", " ", "by", " ", "normal", " ", "with", " ", "X"}],
       "-", "axis"}]}], ";", " ", 
    RowBox[{"if", " ", 
     RowBox[{"(", 
      RowBox[{"\[Theta]", "-", "\[Phi]"}], ")"}], " ", "is", " ", "in", " ", 
     "2", "nd", " ", "quadrant"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "all", " ", "the", " ", "cos", " ", "terms", " ", "will", " ", "be"}], 
    " ", "<", "0"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.843977655812587*^9, 3.8439777950039034`*^9}, {
   3.8439778740392513`*^9, 3.8439779374952283`*^9}, {3.843977970015241*^9, 
   3.843977987565979*^9}, 3.844203010521595*^9, {3.8442030470848064`*^9, 
   3.844203085029853*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"f2fba204-ed90-467b-b66a-0b7f696db07e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cn", "=", 
  RowBox[{"coeffC", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Theta]", "1"], "\[Rule]", "tht1"}], ",", 
     RowBox[{
      SubscriptBox["\[Theta]", "2"], "\[Rule]", "tht2"}], ",", 
     RowBox[{
      SubscriptBox["\[Theta]", "3"], "\[Rule]", "tht3"}], ",", 
     RowBox[{
      SubscriptBox["L", "1"], "\[Rule]", "L1"}], ",", 
     RowBox[{
      SubscriptBox["L", "2"], "\[Rule]", "L2"}], ",", 
     RowBox[{
      SubscriptBox["L", "3"], "\[Rule]", "L3"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.843976219646274*^9, 3.843976228303975*^9}, {
  3.843976275689177*^9, 3.843976304424301*^9}, {3.843976461279847*^9, 
  3.84397649546356*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"13163b2d-4f39-4293-b08b-e22dfa1bd640"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"L1", " ", "ny", " ", 
      RowBox[{"Cos", "[", "tht1", "]"}]}], "-", 
     RowBox[{"L1", " ", "nx", " ", 
      RowBox[{"Sin", "[", "tht1", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"L2", " ", "ny", " ", 
      RowBox[{"Cos", "[", "tht2", "]"}]}], "-", 
     RowBox[{"L2", " ", "nx", " ", 
      RowBox[{"Sin", "[", "tht2", "]"}]}]}], ",", "0"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8439764982543144`*^9, 3.8442030899682965`*^9, 
  3.856943119135701*^9, 3.856944140971196*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"de4648a8-13a9-4012-9a11-f90995992008"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Massmat", "=", 
  RowBox[{"Mmat", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Theta]", "1"], "\[Rule]", "tht1"}], ",", 
     RowBox[{
      SubscriptBox["\[Theta]", "2"], "\[Rule]", "tht2"}], ",", 
     RowBox[{
      SubscriptBox["\[Theta]", "3"], "\[Rule]", "tht3"}], ",", 
     RowBox[{
      SubscriptBox["L", "1"], "\[Rule]", "L1"}], ",", 
     RowBox[{
      SubscriptBox["L", "2"], "\[Rule]", "L2"}], ",", 
     RowBox[{
      SubscriptBox["L", "3"], "\[Rule]", "L3"}], ",", 
     RowBox[{
      SubscriptBox["m", "1"], "\[Rule]", "m1"}], ",", 
     RowBox[{
      SubscriptBox["m", "2"], "\[Rule]", "m2"}], ",", 
     RowBox[{
      SubscriptBox["m", "3"], "\[Rule]", "m3"}], ",", 
     RowBox[{
      SubscriptBox["r", "1"], "\[Rule]", "r1"}], ",", 
     RowBox[{
      SubscriptBox["r", "2"], "\[Rule]", "r2"}], ",", 
     RowBox[{
      SubscriptBox["r", "3"], "\[Rule]", "r3"}], ",", 
     RowBox[{
      SubscriptBox["MI", "1"], "\[Rule]", "MI1"}], ",", 
     RowBox[{
      SubscriptBox["MI", "2"], "\[Rule]", "MI2"}], ",", 
     RowBox[{
      SubscriptBox["MI", "3"], "\[Rule]", "MI3"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8439765118697014`*^9, 3.84397653675928*^9}, {
  3.8439766031449723`*^9, 3.843976718775628*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"47bbf6cf-dafb-4dd6-940f-3c1b096dcd57"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["L1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"m2", "+", "m3"}], ")"}]}], "+", "MI1", "+", 
      RowBox[{"m1", " ", 
       SuperscriptBox["r1", "2"]}]}], ",", 
     RowBox[{
      RowBox[{"L1", " ", "L2", " ", "m3", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"tht1", "-", "tht2"}], "]"}]}], "+", 
      RowBox[{"L1", " ", "m2", " ", "r2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"tht1", "-", "tht2"}], "]"}]}]}], ",", 
     RowBox[{"L1", " ", "m3", " ", "r3", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"tht1", "-", "tht3"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"L1", " ", "L2", " ", "m3", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"tht1", "-", "tht2"}], "]"}]}], "+", 
      RowBox[{"L1", " ", "m2", " ", "r2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"tht1", "-", "tht2"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["L2", "2"], " ", "m3"}], "+", "MI2", "+", 
      RowBox[{"m2", " ", 
       SuperscriptBox["r2", "2"]}]}], ",", 
     RowBox[{"L2", " ", "m3", " ", "r3", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"tht2", "-", "tht3"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"L1", " ", "m3", " ", "r3", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"tht1", "-", "tht3"}], "]"}]}], ",", 
     RowBox[{"L2", " ", "m3", " ", "r3", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"tht2", "-", "tht3"}], "]"}]}], ",", 
     RowBox[{"MI3", "+", 
      RowBox[{"m3", " ", 
       SuperscriptBox["r3", "2"]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.843976698300884*^9, 3.843976720000473*^9}, 
   3.844203092055173*^9, 3.856943119144701*^9, 3.856944140994196*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"c30d7a34-c9c0-473f-b5d3-32a901f5a4a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RHS1", "=", 
  RowBox[{"rhs1", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Theta]", "1"], "\[Rule]", "tht1"}], ",", 
     RowBox[{
      SubscriptBox["\[Theta]", "2"], "\[Rule]", "tht2"}], ",", 
     RowBox[{
      SubscriptBox["\[Theta]", "3"], "\[Rule]", "tht3"}], ",", 
     RowBox[{
      SubscriptBox["\[Omega]", "1"], "\[Rule]", "omg1"}], ",", 
     RowBox[{
      SubscriptBox["\[Omega]", "2"], "\[Rule]", "omg2"}], ",", 
     RowBox[{
      SubscriptBox["\[Omega]", "3"], "\[Rule]", "omg3"}], ",", 
     RowBox[{
      SubscriptBox["L", "1"], "\[Rule]", "L1"}], ",", 
     RowBox[{
      SubscriptBox["L", "2"], "\[Rule]", "L2"}], ",", 
     RowBox[{
      SubscriptBox["L", "3"], "\[Rule]", "L3"}], ",", 
     RowBox[{
      SubscriptBox["m", "1"], "\[Rule]", "m1"}], ",", 
     RowBox[{
      SubscriptBox["m", "2"], "\[Rule]", "m2"}], ",", 
     RowBox[{
      SubscriptBox["m", "3"], "\[Rule]", "m3"}], ",", 
     RowBox[{
      SubscriptBox["r", "1"], "\[Rule]", "r1"}], ",", 
     RowBox[{
      SubscriptBox["r", "2"], "\[Rule]", "r2"}], ",", 
     RowBox[{
      SubscriptBox["r", "3"], "\[Rule]", "r3"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8439767306127496`*^9, 3.843976737478636*^9}, {
  3.843976780517768*^9, 3.843976818076028*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"b9dd0a8a-dfb1-46cd-a4c4-5d84332f952d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "g"}], " ", "L1", " ", "m2", " ", 
     RowBox[{"Cos", "[", "tht1", "]"}]}], "-", 
    RowBox[{"g", " ", "L1", " ", "m3", " ", 
     RowBox[{"Cos", "[", "tht1", "]"}]}], "-", 
    RowBox[{"g", " ", "m1", " ", "r1", " ", 
     RowBox[{"Cos", "[", "tht1", "]"}]}], "-", 
    RowBox[{"L1", " ", "L2", " ", "m3", " ", 
     SuperscriptBox["omg2", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"tht1", "-", "tht2"}], "]"}]}], "-", 
    RowBox[{"L1", " ", "m2", " ", 
     SuperscriptBox["omg2", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"tht1", "-", "tht2"}], "]"}]}], "-", 
    RowBox[{"L1", " ", "m3", " ", 
     SuperscriptBox["omg3", "2"], " ", "r3", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"tht1", "-", "tht3"}], "]"}]}], "+", 
    SubscriptBox["T", "1"], "-", 
    SubscriptBox["T", "2"], "-", 
    SubscriptBox["T", "3"]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "g"}], " ", "L2", " ", "m3", " ", 
     RowBox[{"Cos", "[", "tht2", "]"}]}], "-", 
    RowBox[{"g", " ", "m2", " ", "r2", " ", 
     RowBox[{"Cos", "[", "tht2", "]"}]}], "+", 
    RowBox[{"L1", " ", "L2", " ", "m3", " ", 
     SuperscriptBox["omg1", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"tht1", "-", "tht2"}], "]"}]}], "+", 
    RowBox[{"L1", " ", "m2", " ", 
     SuperscriptBox["omg1", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"tht1", "-", "tht2"}], "]"}]}], "-", 
    RowBox[{"L2", " ", "m3", " ", 
     SuperscriptBox["omg3", "2"], " ", "r3", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"tht2", "-", "tht3"}], "]"}]}], "+", 
    SubscriptBox["T", "2"], "-", 
    SubscriptBox["T", "3"]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "g"}], " ", "m3", " ", "r3", " ", 
     RowBox[{"Cos", "[", "tht3", "]"}]}], "+", 
    RowBox[{"L1", " ", "m3", " ", 
     SuperscriptBox["omg1", "2"], " ", "r3", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"tht1", "-", "tht3"}], "]"}]}], "+", 
    RowBox[{"L2", " ", "m3", " ", 
     SuperscriptBox["omg2", "2"], " ", "r3", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"tht2", "-", "tht3"}], "]"}]}], "+", 
    SubscriptBox["T", "3"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.843976819474555*^9, 3.8442030946382523`*^9, 
  3.8569431191696997`*^9, 3.8569441410041957`*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"c3eec56e-18eb-4875-a70d-5e902808266c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RHS2", "=", 
  RowBox[{"rhs2", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Theta]", "1"], "\[Rule]", "tht1"}], ",", 
     RowBox[{
      SubscriptBox["\[Theta]", "2"], "\[Rule]", "tht2"}], ",", 
     RowBox[{
      SubscriptBox["\[Theta]", "3"], "\[Rule]", "tht3"}], ",", 
     RowBox[{
      SubscriptBox["\[Omega]", "1"], "\[Rule]", "omg1"}], ",", 
     RowBox[{
      SubscriptBox["\[Omega]", "2"], "\[Rule]", "omg2"}], ",", 
     RowBox[{
      SubscriptBox["\[Omega]", "3"], "\[Rule]", "omg3"}], ",", 
     RowBox[{
      SubscriptBox["L", "1"], "\[Rule]", "L1"}], ",", 
     RowBox[{
      SubscriptBox["L", "2"], "\[Rule]", "L2"}], ",", 
     RowBox[{
      SubscriptBox["L", "3"], "\[Rule]", "L3"}], ",", 
     RowBox[{
      SubscriptBox["m", "1"], "\[Rule]", "m1"}], ",", 
     RowBox[{
      SubscriptBox["m", "2"], "\[Rule]", "m2"}], ",", 
     RowBox[{
      SubscriptBox["m", "3"], "\[Rule]", "m3"}], ",", 
     RowBox[{
      SubscriptBox["r", "1"], "\[Rule]", "r1"}], ",", 
     RowBox[{
      SubscriptBox["r", "2"], "\[Rule]", "r2"}], ",", 
     RowBox[{
      SubscriptBox["r", "3"], "\[Rule]", "r3"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8439768295712967`*^9, 3.843976839111327*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"2cb9c2fc-6b32-4615-a0c4-3fba75826790"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"L1", " ", "nx", " ", 
    SuperscriptBox["omg1", "2"], " ", 
    RowBox[{"Cos", "[", "tht1", "]"}]}], "+", 
   RowBox[{"L2", " ", "nx", " ", 
    SuperscriptBox["omg2", "2"], " ", 
    RowBox[{"Cos", "[", "tht2", "]"}]}], "+", 
   RowBox[{"L1", " ", "ny", " ", 
    SuperscriptBox["omg1", "2"], " ", 
    RowBox[{"Sin", "[", "tht1", "]"}]}], "+", 
   RowBox[{"L2", " ", "ny", " ", 
    SuperscriptBox["omg2", "2"], " ", 
    RowBox[{"Sin", "[", "tht2", "]"}]}], "+", 
   RowBox[{"nx", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
    SubscriptBox["R", "ah"], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Theta]", "ah"], "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
   RowBox[{"ny", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
    SubscriptBox["R", "ah"], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Theta]", "ah"], "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
   RowBox[{"ny", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
    SubscriptBox["R", "ah"], " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Theta]", "ah"], "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "+", 
   RowBox[{"nx", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      SubscriptBox["\[Theta]", "ah"], "[", "t", "]"}], "]"}], " ", 
    SubscriptBox["R", "ah"], " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Theta]", "ah"], "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.843976840884369*^9, 3.8442030967967467`*^9, 
  3.8569431191767006`*^9, 3.8569441410261955`*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"3fdc6691-be99-4272-a24a-379f777baf86"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"<<", "ToMatlab.m"}]], "Input",
 CellChangeTimes->{{3.8439769972559843`*^9, 3.8439770022935085`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"28345dbf-267c-4240-a3f5-e307cdebf598"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToMatlab", "[", 
  RowBox[{"Massmat", ",", "\"\<Mmat\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.843977011426675*^9, 3.843977022517573*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"fc73fce3-a0e6-41dc-a534-76509cb8557d"],

Cell[BoxData["\<\"Mmat=[L1.^2.*(m2+m3)+MI1+m1.*r1.^2,L1.*L2.*m3.*cos(tht1+(-1)\
.*tht2)+ ...\\n  \
L1.*m2.*r2.*cos(tht1+(-1).*tht2),L1.*m3.*r3.*cos(tht1+(-1).*tht3); ...\\n  \
L1.*L2.*m3.*cos(tht1+(-1).*tht2)+L1.*m2.*r2.*cos(tht1+(-1).*tht2), ...\\n  \
L2.^2.*m3+MI2+m2.*r2.^2,L2.*m3.*r3.*cos(tht2+(-1).*tht3);L1.*m3.* ...\\n  \
r3.*cos(tht1+(-1).*tht3),L2.*m3.*r3.*cos(tht2+(-1).*tht3),MI3+m3.* ...\\n  \
r3.^2];\\n\"\>"], "Output",
 CellChangeTimes->{3.843977023383626*^9, 3.844203098637044*^9, 
  3.856943119212701*^9, 3.8569441410521965`*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"e8d2a6d5-ca38-41c2-bae3-9a784d0a6c2b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToMatlab", "[", 
  RowBox[{"Cn", ",", "\"\<Cn\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.8439770365861897`*^9, 3.8439770488281183`*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"3cfccedf-99cf-4b79-ac3d-35e4e5dca944"],

Cell[BoxData["\<\"Cn=[L1.*ny.*cos(tht1)+(-1).*L1.*nx.*sin(tht1),L2.*ny.*cos(\
tht2)+(-1) ...\\n  .*L2.*nx.*sin(tht2),0];\\n\"\>"], "Output",
 CellChangeTimes->{3.843977050027956*^9, 3.84420310067682*^9, 
  3.8569431192357006`*^9, 3.8569441410711994`*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"85604caa-435a-4ff7-8979-fb4aa96d9e7c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToMatlab", "[", 
  RowBox[{"RHS1", ",", "\"\<rhs1\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.8439770594903584`*^9, 3.8439770711884303`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"659dc680-59f8-49f7-9a5d-219351f91de8"],

Cell[BoxData["\<\"rhs1=[(-1).*g.*L1.*m2.*cos(tht1)+(-1).*g.*L1.*m3.*cos(tht1)+\
(-1).*g.* ...\\\\n  \
m1.*r1.*cos(tht1)+(-1).*L1.*L2.*m3.*omg2.^2.*sin(tht1+(-1).*tht2)+ ...\\\\n  \
(-1).*L1.*m2.*omg2.^2.*r2.*sin(tht1+(-1).*tht2)+(-1).*L1.*m3.* ...\\\\n  \
omg3.^2.*r3.*sin(tht1+(-1).*tht3)+Subscript(T,1)+(-1).*Subscrip( ...\
\[AliasDelimiter]\\\\n  \
T,2)+(-1).*Subscript(T,3),(-1).*g.*L2.*m3.*cos(tht2)+(-1).*g.*m2.* ...\\\\n  \
r2.*cos(tht2)+L1.*L2.*m3.*omg1.^2.*sin(tht1+(-1).*tht2)+L1.*m2.* ...\\\\n  \
omg1.^2.*r2.*sin(tht1+(-1).*tht2)+(-1).*L2.*m3.*omg3.^2.*r3.*sin( ...\\\\n  \
tht2+(-1).*tht3)+Subscript(T,2)+(-1).*Subscript(T,3),(-1).*g.*m3.* ...\\\\n  \
r3.*cos(tht3)+L1.*m3.*omg1.^2.*r3.*sin(tht1+(-1).*tht3)+L2.*m3.* ...\\\\n  \
omg2.^2.*r3.*sin(tht2+(-1).*tht3)+Subscript(T,3)];\\\\n\"\>"], "Output",
 CellChangeTimes->{3.8439770724793587`*^9, 3.8442031028120766`*^9, 
  3.8569431192597*^9, 3.856944141091194*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"d415820e-aa2a-405e-b3bc-8edf7d319851"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToMatlab", "[", 
  RowBox[{"RHS2", ",", "\"\<rhs2\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.84397707533204*^9, 3.843977085317168*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"f0c1bf41-0320-4c27-91c1-4cb638151a2b"],

Cell[BoxData["\<\"rhs2=[L1.*nx.*omg1.^2.*cos(tht1)+L2.*nx.*omg2.^2.*cos(tht2)+\
L1.*ny.* ...\\n  \
omg1.^2.*sin(tht1)+L2.*ny.*omg2.^2.*sin(tht2)+nx.*cos(Subscript(\[Theta], ...\
\\n  ah)(t)).*Subscript(R,ah).*Derivative(1)(Subscript(\[Theta],ah))(t).^2+ \
...\\n  ny.*sin(Subscript(\[Theta],ah)(t)).*Subscript(R,ah).*Derivative(1)( \
...\\n  Subscript(\[Theta],ah))(t).^2+(-1).*ny.*cos(Subscript(\[Theta],ah)(t))\
.* ...\\n  Subscript(R,ah).*Derivative(2)(Subscript(\[Theta],ah))(t)+nx.*sin( \
...\\n  Subscript(\[Theta],ah)(t)).*Subscript(R,ah).*Derivative(2)(Subscript(\
\[Theta], ...\\n  ah))(t)];\\n\"\>"], "Output",
 CellChangeTimes->{3.843977086577261*^9, 3.8442031052197742`*^9, 
  3.856943119265701*^9, 3.856944141110194*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"457188c5-95b8-4f35-ace9-eebf38ce004f"]
}, Open  ]]
}, Open  ]]
},
WindowMargins->{{-6, Automatic}, {Automatic, -6}},
Magnification:>1.25 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fda70d4b-c53d-47b9-ba3e-a62bbfbb331a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 261, 4, 122, "Title",ExpressionUUID->"be1f2814-cac0-4e42-bb4d-19c2b6a6a3a6"],
Cell[844, 28, 6352, 115, 624, "Subtitle",ExpressionUUID->"d6eec35f-036f-4c44-a625-1f4a3a55b1fc"],
Cell[7199, 145, 4705, 160, 297, "Input",ExpressionUUID->"7681f55b-0581-4fff-af80-563ef90bd2f7"],
Cell[11907, 307, 7715, 246, 301, "Input",ExpressionUUID->"ff8e1427-16d5-4326-83bb-c0860df068a2"],
Cell[19625, 555, 230, 4, 43, "Text",ExpressionUUID->"318b85a9-e273-4f74-b31c-96c8b419dc1a"],
Cell[19858, 561, 2646, 81, 60, "Input",ExpressionUUID->"cfc5c6f9-08c4-4ac9-bd32-dc2b6190c82d"],
Cell[22507, 644, 225, 4, 43, "Text",ExpressionUUID->"217b16d4-6999-48ec-a50b-41975b580b91"],
Cell[CellGroupData[{
Cell[22757, 652, 6603, 216, 353, "Input",ExpressionUUID->"b4996eb1-9360-40a9-9d40-7da579894fc7"],
Cell[29363, 870, 9158, 280, 210, "Output",ExpressionUUID->"6847be39-87aa-4fe4-bd2d-0ed987227bd2"]
}, Open  ]],
Cell[38536, 1153, 1108, 32, 155, "Input",ExpressionUUID->"b6c017aa-43af-41b1-bef9-efed002f18ab"],
Cell[39647, 1187, 3410, 103, 85, "Input",ExpressionUUID->"4053694e-ed54-4ea5-9b35-87144c8f80c1"],
Cell[43060, 1292, 644, 21, 85, "Input",ExpressionUUID->"fcfdde4a-fc31-4fe1-a2fa-9942ba8e7abf"],
Cell[43707, 1315, 4961, 147, 85, "Input",ExpressionUUID->"9c5da377-5c8d-490f-9b3a-54dd51712bb7"],
Cell[CellGroupData[{
Cell[48693, 1466, 272, 5, 35, "Input",ExpressionUUID->"bcc0a1a7-f25e-40d9-8e42-1391b73920b7"],
Cell[48968, 1473, 3529, 104, 72, "Output",ExpressionUUID->"33fd5c6c-667b-4716-bd7c-db717932621d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52534, 1582, 270, 5, 35, "Input",ExpressionUUID->"e5fbfb58-fac4-4119-abea-0b5e84eb881c"],
Cell[52807, 1589, 3165, 92, 72, "Output",ExpressionUUID->"a5685664-1ed6-4741-b24e-cd9bef6e618f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56009, 1686, 272, 5, 35, "Input",ExpressionUUID->"aafbd9b4-8678-467f-a63c-6250d1c6a4a1"],
Cell[56284, 1693, 1798, 53, 45, "Output",ExpressionUUID->"5d04a65c-083e-483c-b634-619eba4a2f03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58119, 1751, 922, 24, 83, "Input",ExpressionUUID->"47ead4f3-2a6f-4629-b16e-ca1fc1890901"],
Cell[59044, 1777, 3748, 113, 108, "Output",ExpressionUUID->"bd2cb327-efbf-476b-9c6e-1660a5ced352"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62829, 1895, 856, 23, 60, "Input",ExpressionUUID->"d8a1e8d1-6627-4525-8a95-2c6e496c8770"],
Cell[63688, 1920, 4111, 120, 96, "Output",ExpressionUUID->"5189e315-b221-4a0c-8051-1b6e8ca4f44b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67836, 2045, 656, 16, 35, "Input",ExpressionUUID->"282f86b8-fff6-434c-80ff-1a3a66b33f5b"],
Cell[68495, 2063, 957, 27, 40, "Output",ExpressionUUID->"c59eaba6-6119-4f72-88f1-aff43ae358a4"]
}, Open  ]],
Cell[69467, 2093, 427, 8, 43, "Text",ExpressionUUID->"e1e0c561-292b-43fa-8984-908957456adf"],
Cell[69897, 2103, 172, 3, 43, "Text",ExpressionUUID->"95b7c19b-7039-4d2a-8cef-51142c43bbc4"],
Cell[CellGroupData[{
Cell[70094, 2110, 419, 9, 60, "Input",ExpressionUUID->"665cb163-9d4e-4d72-86bb-ee1b6f8f6e36"],
Cell[70516, 2121, 2319, 67, 40, "Output",ExpressionUUID->"0fc69d17-33a6-4abb-97f9-730a4b900a8b"],
Cell[72838, 2190, 4450, 128, 72, "Output",ExpressionUUID->"f3738494-e4bf-4baf-b74d-5caa7a255732"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77325, 2323, 2804, 81, 60, "Input",ExpressionUUID->"891a5d2a-3d5b-463d-830e-855749c9813a"],
Cell[80132, 2406, 1745, 50, 40, "Output",ExpressionUUID->"0a0d6baa-285f-4909-b33c-db542d37b13b"],
Cell[81880, 2458, 3183, 90, 72, "Output",ExpressionUUID->"b1d273c1-e60d-4507-9720-4933cc4c6deb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85100, 2553, 845, 23, 83, "Input",ExpressionUUID->"cc655fd2-3cdf-4fca-95ef-3dac43bbbb07"],
Cell[85948, 2578, 926, 25, 40, "Output",ExpressionUUID->"e8e9094c-1e43-4a6d-8ab3-dbbcf7d1a6ce"],
Cell[86877, 2605, 2334, 64, 72, "Output",ExpressionUUID->"8a320cd7-b441-45c4-93e1-0e0e40400c2e"]
}, Open  ]],
Cell[89226, 2672, 3053, 80, 117, "Input",ExpressionUUID->"f2fba204-ed90-467b-b66a-0b7f696db07e"],
Cell[CellGroupData[{
Cell[92304, 2756, 791, 20, 35, "Input",ExpressionUUID->"13163b2d-4f39-4293-b08b-e22dfa1bd640"],
Cell[93098, 2778, 654, 17, 40, "Output",ExpressionUUID->"de4648a8-13a9-4012-9a11-f90995992008"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93789, 2800, 1376, 37, 35, "Input",ExpressionUUID->"47bbf6cf-dafb-4dd6-940f-3c1b096dcd57"],
Cell[95168, 2839, 1927, 52, 100, "Output",ExpressionUUID->"c30d7a34-c9c0-473f-b5d3-32a901f5a4a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97132, 2896, 1393, 37, 35, "Input",ExpressionUUID->"b9dd0a8a-dfb1-46cd-a4c4-5d84332f952d"],
Cell[98528, 2935, 2428, 61, 96, "Output",ExpressionUUID->"c3eec56e-18eb-4875-a70d-5e902808266c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100993, 3001, 1344, 36, 35, "Input",ExpressionUUID->"2cb9c2fc-6b32-4615-a0c4-3fba75826790"],
Cell[102340, 3039, 2029, 55, 72, "Output",ExpressionUUID->"3fdc6691-be99-4272-a24a-379f777baf86"]
}, Open  ]],
Cell[104384, 3097, 203, 3, 35, "Input",ExpressionUUID->"28345dbf-267c-4240-a3f5-e307cdebf598"],
Cell[CellGroupData[{
Cell[104612, 3104, 246, 4, 35, "Input",ExpressionUUID->"fc73fce3-a0e6-41dc-a534-76509cb8557d"],
Cell[104861, 3110, 625, 9, 183, "Output",ExpressionUUID->"e8d2a6d5-ca38-41c2-bae3-9a784d0a6c2b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105523, 3124, 243, 4, 35, "Input",ExpressionUUID->"3cfccedf-99cf-4b79-ac3d-35e4e5dca944"],
Cell[105769, 3130, 333, 4, 88, "Output",ExpressionUUID->"85604caa-435a-4ff7-8979-fb4aa96d9e7c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106139, 3139, 247, 4, 35, "Input",ExpressionUUID->"659dc680-59f8-49f7-9a5d-219351f91de8"],
Cell[106389, 3145, 1006, 14, 183, "Output",ExpressionUUID->"d415820e-aa2a-405e-b3bc-8edf7d319851"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107432, 3164, 242, 4, 35, "Input",ExpressionUUID->"f0c1bf41-0320-4c27-91c1-4cb638151a2b"],
Cell[107677, 3170, 812, 11, 231, "Output",ExpressionUUID->"457188c5-95b8-4f35-ace9-eebf38ce004f"]
}, Open  ]]
}, Open  ]]
}
]
*)

